log_format jsonlog escape=json '{"time":"$time_iso8601",'
  '"node":"0",'
  '"ip":"$remote_addr",'
  '"ip_class":"127",'
  '"request_id":"$request_id",'
  '"client_uid":"$uid_got$uid_set",'
  '"client_new":"",'
  '"client_cn":"ssl_client_s_dn_cn",'
  '"user_id":"",'
  '"waf_mode":"0",'

  '"protection_mode":"$protection_config_challenge",'
  '"protection_challenge":"$sent_http_x_protection_challenge",'
  '"protection_acl":"$auth_response_protection_acl",'

  '"agent_name":"agent_name",'
  '"agent_version":"agent_version_major",'
  '"agent_os":"agent_os",'
  '"agent_os_version":"agent_os_version_major",'
  '"agent_category":"agent_category",'
  '"agent_vendor":"agent_vendor",'
  '"agent_all":"agent_all",'
  '"user_agent_hash":"user_agent_hash",'

  '"scheme":"$scheme",'
  '"method":"$request_method",'
  '"http2":"$http2",'
  '"user_agent":"$http_user_agent",'
  '"ssl_version":"$ssl_protocol",'
  '"host":"$http_host",'
  '"request_uri":"$request_uri",'
  '"request_length":"$request_length",'
  '"status":"$status",'
  '"bytes_sent":"$bytes_sent",'
  '"body_bytes_sent":"$body_bytes_sent",'
  '"referer":"$http_referer",'
  '"foreign_referer_host":"",'
  '"request_time":"$request_time",'
  '"content_type":"$sent_http_content_type",'
  '"content_length":"$sent_http_content_length",'

  '"brotli_ratio":"0.5",'
  '"gzip_ratio":"0.5",'

  '"ps_org_content_length":"1024",'
  '"ps_active":"1",'

  '"upstream_bytes_received":"$upstream_bytes_received",'
  '"upstream_bytes_sent":"$upstream_bytes_sent",'
  '"upstream_connect_time":"$upstream_connect_time",'
  '"upstream_header_time":"$upstream_header_time",'
  '"upstream_response_length":"$upstream_response_length",'
  '"upstream_response_time":"$upstream_response_time",'
  '"upstream_cache_status":"$upstream_cache_status"}';

error_log syslog:server=127.0.0.1:5140 debug;
access_log syslog:server=127.0.0.1:5141 jsonlog;

server {
  listen 80 default_server;
  server_name _;
  location / {
    add_header 'Content-Type' 'text/plain';
    return 200 'ok';
  }
  location /proxy-test {
    # upstream not exist for produce an error
    proxy_pass http://127.0.0.1:65000;
  }
}
